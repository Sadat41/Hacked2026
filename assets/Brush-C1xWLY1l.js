import{r as d}from"./index-CK6zvB4W.js";import{r as R,u as $,s as F,b as Y,c as G,d as L,e as q,f as J,g as Q,i as I,h as Z,j,P as ee,p as te,k as re,l as H,m as ae,n as k,o as ne}from"./BarChart-2PTZnhLz.js";function C(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),t.push.apply(t,r)}return t}function W(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?C(Object(t),!0).forEach(function(r){le(a,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(t,r))})}return a}function le(a,e,t){return(e=ie(e))in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function ie(a){var e=se(a,"string");return typeof e=="symbol"?e:e+""}function se(a,e){if(typeof a!="object"||!a)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var r=t.call(a,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}var oe=["Webkit","Moz","O","ms"],de=(a,e)=>{var t=a.replace(/(\w)/,n=>n.toUpperCase()),r=oe.reduce((n,l)=>W(W({},n),{},{[l+t]:e}),{});return r[a]=e,r},he=d.createContext(()=>{});function S(){return S=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(a[r]=t[r])}return a},S.apply(null,arguments)}function B(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),t.push.apply(t,r)}return t}function w(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?B(Object(t),!0).forEach(function(r){y(a,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):B(Object(t)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(t,r))})}return a}function y(a,e,t){return(e=ue(e))in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function ue(a){var e=ve(a,"string");return typeof e=="symbol"?e:e+""}function ve(a,e){if(typeof a!="object"||!a)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var r=t.call(a,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function ce(a){var{x:e,y:t,width:r,height:n,stroke:l}=a,i=Math.floor(t+n/2)-1;return d.createElement(d.Fragment,null,d.createElement("rect",{x:e,y:t,width:r,height:n,fill:l,stroke:"none"}),d.createElement("line",{x1:e+1,y1:i,x2:e+r-1,y2:i,fill:"none",stroke:"#fff"}),d.createElement("line",{x1:e+1,y1:i+2,x2:e+r-1,y2:i+2,fill:"none",stroke:"#fff"}))}function fe(a){var{travellerProps:e,travellerType:t}=a;return d.isValidElement(t)?d.cloneElement(t,e):typeof t=="function"?t(e):d.createElement(ce,e)}function K(a){if(H(a)&&typeof a=="object"&&"name"in a&&typeof a.name=="string")return a.name}function ge(a,e,t){var r=K(a[e]),n=K(a[t]);return"Min value: ".concat(r,", Max value: ").concat(n)}function A(a){var{otherProps:e,travellerX:t,id:r,onMouseEnter:n,onMouseLeave:l,onMouseDown:i,onTouchStart:s,onTravellerMoveKeyboard:o,onFocus:u,onBlur:v}=a,{y:h,x:c,travellerWidth:f,height:g,traveller:m,ariaLabel:p,data:T,startIndex:x,endIndex:b}=e,X=Math.max(t,c),D=w(w({},ae(e)),{},{x:X,y:h,width:f,height:g}),P=p||ge(T,x,b);return d.createElement(j,{tabIndex:0,role:"slider","aria-label":P,"aria-valuenow":t,className:"recharts-brush-traveller",onMouseEnter:n,onMouseLeave:l,onMouseDown:i,onTouchStart:s,onKeyDown:M=>{["ArrowLeft","ArrowRight"].includes(M.key)&&(M.preventDefault(),M.stopPropagation(),o(M.key==="ArrowRight"?1:-1,r))},onFocus:u,onBlur:v,style:{cursor:"col-resize"}},d.createElement(fe,{travellerType:m,travellerProps:D}))}function N(a){var{index:e,data:t,tickFormatter:r,dataKey:n}=a,l=ne(t[e],n,e);return typeof r=="function"?r(l,e):l}function _(a,e){for(var t=a.length,r=0,n=t-1;n-r>1;){var l=Math.floor((r+n)/2),i=a[l];i!=null&&i>e?n=l:r=l}var s=a[n];return s!=null&&e>=s?n:r}function O(a){var{startX:e,endX:t,scaleValues:r,gap:n,data:l}=a,i=l.length-1,s=Math.min(e,t),o=Math.max(e,t),u=_(r,s),v=_(r,o);return{startIndex:u-u%n,endIndex:v===i?i:v-v%n}}function me(a){var{x:e,y:t,width:r,height:n,fill:l,stroke:i}=a;return d.createElement("rect",{stroke:i,fill:l,x:e,y:t,width:r,height:n})}function pe(a){var{startIndex:e,endIndex:t,y:r,height:n,travellerWidth:l,stroke:i,tickFormatter:s,dataKey:o,data:u,startX:v,endX:h}=a,c=5,f={pointerEvents:"none",fill:i};return d.createElement(j,{className:"recharts-brush-texts"},d.createElement(k,S({textAnchor:"end",verticalAnchor:"middle",x:Math.min(v,h)-c,y:r+n/2},f),N({index:e,tickFormatter:s,dataKey:o,data:u})),d.createElement(k,S({textAnchor:"start",verticalAnchor:"middle",x:Math.max(v,h)+l+c,y:r+n/2},f),N({index:t,tickFormatter:s,dataKey:o,data:u})))}function xe(a){var{y:e,height:t,stroke:r,travellerWidth:n,startX:l,endX:i,onMouseEnter:s,onMouseLeave:o,onMouseDown:u,onTouchStart:v}=a,h=Math.min(l,i)+n,c=Math.max(Math.abs(i-l)-n,0);return d.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:s,onMouseLeave:o,onMouseDown:u,onTouchStart:v,style:{cursor:"move"},stroke:"none",fill:r,fillOpacity:.2,x:h,y:e,width:c,height:t})}function ye(a){var{x:e,y:t,width:r,height:n,data:l,children:i,padding:s}=a,o=d.Children.count(i)===1;if(!o)return null;var u=d.Children.only(i);return u?d.cloneElement(u,{x:e,y:t,width:r,height:n,margin:s,compact:!0,data:l}):null}var Te=a=>{var{data:e,startIndex:t,endIndex:r,x:n,width:l,travellerWidth:i}=a;if(!e||!e.length)return{};var s=e.length,o=te().domain(re(0,s)).range([n,n+l-i]),u=o.domain().map(v=>o(v)).filter(H);return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:o(t),endX:o(r),scale:o,scaleValues:u}},V=a=>a.changedTouches&&!!a.changedTouches.length;class be extends d.PureComponent{constructor(e){super(e),y(this,"handleDrag",t=>{this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.state.isTravellerMoving?this.handleTravellerMove(t):this.state.isSlideMoving&&this.handleSlideDrag(t)}),y(this,"handleTouchMove",t=>{var r,n=(r=t.changedTouches)===null||r===void 0?void 0:r[0];n!=null&&this.handleDrag(n)}),y(this,"handleDragEnd",()=>{this.setState({isTravellerMoving:!1,isSlideMoving:!1},()=>{var{endIndex:t,onDragEnd:r,startIndex:n}=this.props;r?.({endIndex:t,startIndex:n})}),this.detachDragEndListener()}),y(this,"handleLeaveWrapper",()=>{(this.state.isTravellerMoving||this.state.isSlideMoving)&&(this.leaveTimer=window.setTimeout(this.handleDragEnd,this.props.leaveTimeOut))}),y(this,"handleEnterSlideOrTraveller",()=>{this.setState({isTextActive:!0})}),y(this,"handleLeaveSlideOrTraveller",()=>{this.setState({isTextActive:!1})}),y(this,"handleSlideDragStart",t=>{var r=V(t)?t.changedTouches[0]:t;r!=null&&(this.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:r.pageX}),this.attachDragEndListener())}),y(this,"handleTravellerMoveKeyboard",(t,r)=>{var{data:n,gap:l,startIndex:i,endIndex:s}=this.props,{scaleValues:o,startX:u,endX:v}=this.state;if(o!=null){var h=-1;if(r==="startX"?h=i:r==="endX"&&(h=s),!(h<0||h>=n.length)){var c=h+t;if(!(c===-1||c>=o.length)){var f=o[c];f!=null&&(r==="startX"&&f>=v||r==="endX"&&f<=u||this.setState({[r]:f},()=>{this.props.onChange(O({startX:this.state.startX,endX:this.state.endX,data:n,gap:l,scaleValues:o}))}))}}}}),this.travellerDragStartHandlers={startX:this.handleTravellerDragStart.bind(this,"startX"),endX:this.handleTravellerDragStart.bind(this,"endX")},this.state={brushMoveStartX:0,movingTravellerId:void 0,endX:0,startX:0,slideMoveStartX:0}}static getDerivedStateFromProps(e,t){var{data:r,width:n,x:l,travellerWidth:i,startIndex:s,endIndex:o,startIndexControlledFromProps:u,endIndexControlledFromProps:v}=e;if(r!==t.prevData)return w({prevData:r,prevTravellerWidth:i,prevX:l,prevWidth:n},r&&r.length?Te({data:r,width:n,x:l,travellerWidth:i,startIndex:s,endIndex:o}):{scale:void 0,scaleValues:void 0});var h=t.scale;if(h&&(n!==t.prevWidth||l!==t.prevX||i!==t.prevTravellerWidth)){h.range([l,l+n-i]);var c=h.domain().map(f=>h(f)).filter(f=>f!=null);return{prevData:r,prevTravellerWidth:i,prevX:l,prevWidth:n,startX:h(e.startIndex),endX:h(e.endIndex),scaleValues:c}}if(t.scale&&!t.isSlideMoving&&!t.isTravellerMoving&&!t.isTravellerFocused&&!t.isTextActive){if(u!=null&&t.prevStartIndexControlledFromProps!==u)return{startX:t.scale(u),prevStartIndexControlledFromProps:u};if(v!=null&&t.prevEndIndexControlledFromProps!==v)return{endX:t.scale(v),prevEndIndexControlledFromProps:v}}return null}componentWillUnmount(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}attachDragEndListener(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}detachDragEndListener(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}handleSlideDrag(e){var{slideMoveStartX:t,startX:r,endX:n,scaleValues:l}=this.state;if(l!=null){var{x:i,width:s,travellerWidth:o,startIndex:u,endIndex:v,onChange:h,data:c,gap:f}=this.props,g=e.pageX-t;g>0?g=Math.min(g,i+s-o-n,i+s-o-r):g<0&&(g=Math.max(g,i-r,i-n));var m=O({startX:r+g,endX:n+g,data:c,gap:f,scaleValues:l});(m.startIndex!==u||m.endIndex!==v)&&h&&h(m),this.setState({startX:r+g,endX:n+g,slideMoveStartX:e.pageX})}}handleTravellerDragStart(e,t){var r=V(t)?t.changedTouches[0]:t;r!=null&&(this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:e,brushMoveStartX:r.pageX}),this.attachDragEndListener())}handleTravellerMove(e){var{brushMoveStartX:t,movingTravellerId:r,endX:n,startX:l,scaleValues:i}=this.state;if(!(r==null||i==null)){var s=this.state[r],{x:o,width:u,travellerWidth:v,onChange:h,gap:c,data:f}=this.props,g={startX:this.state.startX,endX:this.state.endX,data:f,gap:c,scaleValues:i},m=e.pageX-t;m>0?m=Math.min(m,o+u-v-s):m<0&&(m=Math.max(m,o-s)),g[r]=s+m;var p=O(g),{startIndex:T,endIndex:x}=p,b=()=>{var X=f.length-1;return r==="startX"&&(n>l?T%c===0:x%c===0)||n<l&&x===X||r==="endX"&&(n>l?x%c===0:T%c===0)||n>l&&x===X};this.setState({[r]:s+m,brushMoveStartX:e.pageX},()=>{h&&b()&&h(p)})}}render(){var{data:e,className:t,children:r,x:n,y:l,dy:i,width:s,height:o,alwaysShowText:u,fill:v,stroke:h,startIndex:c,endIndex:f,travellerWidth:g,tickFormatter:m,dataKey:p,padding:T}=this.props,{startX:x,endX:b,isTextActive:X,isSlideMoving:D,isTravellerMoving:P,isTravellerFocused:M}=this.state;if(!e||!e.length||!I(n)||!I(l)||!I(s)||!I(o)||s<=0||o<=0)return null;var U=Z("recharts-brush",t),z=de("userSelect","none"),E=l+(i??0);return d.createElement(j,{className:U,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:z},d.createElement(me,{x:n,y:E,width:s,height:o,fill:v,stroke:h}),d.createElement(ee,null,d.createElement(ye,{x:n,y:E,width:s,height:o,data:e,padding:T},r)),d.createElement(xe,{y:E,height:o,stroke:h,travellerWidth:g,startX:x,endX:b,onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart}),d.createElement(A,{travellerX:x,id:"startX",otherProps:w(w({},this.props),{},{y:E}),onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers.startX,onTouchStart:this.travellerDragStartHandlers.startX,onTravellerMoveKeyboard:this.handleTravellerMoveKeyboard,onFocus:()=>{this.setState({isTravellerFocused:!0})},onBlur:()=>{this.setState({isTravellerFocused:!1})}}),d.createElement(A,{travellerX:b,id:"endX",otherProps:w(w({},this.props),{},{y:E}),onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers.endX,onTouchStart:this.travellerDragStartHandlers.endX,onTravellerMoveKeyboard:this.handleTravellerMoveKeyboard,onFocus:()=>{this.setState({isTravellerFocused:!0})},onBlur:()=>{this.setState({isTravellerFocused:!1})}}),(X||D||P||M||u)&&d.createElement(pe,{startIndex:c,endIndex:f,y:E,height:o,travellerWidth:g,stroke:h,tickFormatter:m,dataKey:p,data:e,startX:x,endX:b}))}}function we(a){var e=$(),t=Y(),r=G(),n=d.useContext(he),l=a.onChange,{startIndex:i,endIndex:s}=a;d.useEffect(()=>{e(L({startIndex:i,endIndex:s}))},[e,s,i]),q();var o=d.useCallback(p=>{if(r!=null){var{startIndex:T,endIndex:x}=r;(p.startIndex!==T||p.endIndex!==x)&&(n?.(p),l?.(p),e(L(p)))}},[l,n,e,r]),u=J(Q);if(u==null||r==null||t==null||!t.length)return null;var{startIndex:v,endIndex:h}=r,{x:c,y:f,width:g}=u,m={data:t,x:c,y:f,width:g,startIndex:v,endIndex:h,onChange:o};return d.createElement(be,S({},a,m,{startIndexControlledFromProps:i??void 0,endIndexControlledFromProps:s??void 0}))}function Xe(a){var e=$();return d.useEffect(()=>(e(F(a)),()=>{e(F(null))}),[e,a]),null}var Me={height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1};function Ee(a){var e=R(a,Me);return d.createElement(d.Fragment,null,d.createElement(Xe,{height:e.height,x:e.x,y:e.y,width:e.width,padding:e.padding}),d.createElement(we,e))}Ee.displayName="Brush";export{Ee as B};
